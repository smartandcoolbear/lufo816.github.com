---
author: lufo
comments: true
date: 2014-05-20 08:32:27+00:00
layout: post
slug: '%e7%94%a8%e4%ba%8e%e5%b0%86%e6%91%84%e5%83%8f%e5%a4%b4%e5%9b%be%e5%83%8f%e8%bd%ac%e6%8d%a2%e4%b8%baascii%e5%ad%97%e7%ac%a6%e8%a1%a8%e7%a4%ba%e7%9a%84%e8%84%9a%e6%9c%ac'
title: 用于将摄像头图像转换为ASCII字符表示的脚本
wordpress_id: 208
tags:
- skill
- python
---

最近在github上发现了一个小项目，它能将摄像头截取到的图像用ASCII字符表示出来，项目地址：https://github.com/mustafaakin/terminal-webcam。

有两种模式，一种是黑白的，一种是彩色的，试了下彩色的基本不能用，黑白的注释了一下：

[python]

import cv2.cv as cv#图形处理库
import os
import sys
import math
import curses#便于命令行显示的库
import signal#处理信号的库，信号是UNIX软件上对中断的模拟

#处理信号的函数，ctrl+c终止程序
def signal_handler(signal, frame):
print 'You pressed Ctrl+C!'
curses.endwin()
sys.exit(0)

#调用处理信号的函数
signal.signal(signal.SIGINT, signal_handler)

#创建一个窗口
stdscr = curses.initscr()

#设置用于表示图像的字符
palette = [' ', '.', '.', '/', 'c', '(', '$', '#', '@']

#获取摄像头信息
capture = cv.CaptureFromCAM(0)

#获取命令行的大小
(rows, columns) = os.popen('stty size', 'r').read().split()
rows = int(rows)
columns = int(columns)

while True:
#从摄像头截取帧
img = cv.QueryFrame(capture)

#生成新的图像，和命令行大小一样
thumbnail = cv.CreateImage(
(columns, rows),
img.depth,
img.nChannels
)

cv.Resize(img, thumbnail)

img = thumbnail

#对命令行窗口的每个坐标根据色深进行替换
for x in xrange(img.height):
for y in xrange(img.width):
b, g, r = img[x, y]
value = 0.1145 * b + g * 0.5866 + r * 0.2989
index = int(math.floor(value / (256.0 / (len(palette)))))

try:
#将(x,y)点换为palette[index]
stdscr.move(x, y)
stdscr.addch(palette[index])
except:
pass

stdscr.refresh()

[/python]
